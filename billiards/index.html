<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>RyanbowZ</title><meta name="author" content="Yuanlong Zhou"><link rel="shortcut icon" href="/img/favicon.png"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><meta name="generator" content="Hexo 6.2.0"><link rel="alternate" href="/atom.xml" title="RyanbowZ" type="application/atom+xml">
</head><body><header id="page_header"><div class="header_wrap"><div id="blog_name"><a class="blog_title" id="site-name" href="/">RyanbowZ</a></div><button class="menus_icon"><div class="navicon"></div></button><ul class="menus_items"><li class="menus_item"><a class="site-page" href="/research"> Project</a></li><li class="menus_item"><a class="site-page" href="/works"> Game</a></li><li class="menus_item"><a class="site-page" href="/exps"> Award</a></li><li class="menus_item"><a class="site-page" href="/awards"> Certificate</a></li><li class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://github.com/RyanbowZ"> GitHub</a></li><li class="menus_item"><a class="site-page" href="/"> About</a></li></ul></div></header><main id="page_main"><div class="side-card sticky"><div class="card-wrap" itemscope itemtype="http://schema.org/Person"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/pro.png'" alt="avatar"></div><div class="author-discrip"><h3>Yuanlong Zhou</h3><p class="author-bio">SDE @ TikTok | GenAI AWS @ Amazon | LLM @ GSoC 2024 | AIGC/CV/CG Full Stack | AI Researcher  Empower by Creativity.</p></div><div class="author-links"><button class="btn m-social-links">Links</button><ul class="social-icons"><li><a class="social-icon" href="https://www.linkedin.com/in/ryanbowz/" target="_blank"><i class="fab fa-linkedin" aria-hidden="true"></i></a></li><li><a class="social-icon" href="https://github.com/RyanbowZ" target="_blank"><i class="fab fa-github" aria-hidden="true"></i></a></li><li><a class="social-icon" href="mailto:[RyanbowZ@outlook.com]" target="_blank"><i class="fas fa-envelope" aria-hidden="true"></i></a></li><li><a class="social-icon" href="https://blog.csdn.net/Rainbowstarter" target="_blank"><i class="fab fa-stack-overflow" aria-hidden="true"></i></a></li><li><a class="social-icon" href="https://twitter.com/ye_hou7263" target="_blank"><i class="fab fa-twitter" aria-hidden="true"></i></a></li></ul></div><a class="cv-links" href="/attaches/CV24.pdf" target="_blank"><i class="fas fa-file-pdf" aria-hidden="true"><span>My Resume / CV</span></i></a></div></div><div class="page" itemscope itemtype="http://schema.org/CreativeWork"><h2 class="page-title">A Billiard Ball Simulation Game with Adaptive AI Opponent and Genetic Algorithm Optimization</h2><article><div align="center">
<iframe width="960" height="550" src="https://www.youtube.com/embed/0GaSXVt4Lvo?si=NZCk5ap8zueQFMdR" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>

<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>This is a billiard ball simulation game with integration of force simulation, collision detection, event handling, and adaptive AI opponent algorithm (the difficultest part of this project).</p>
<h2 id="Keypoints"><a href="#Keypoints" class="headerlink" title="Keypoints"></a>Keypoints</h2><ol>
<li>Use <a target="_blank" rel="noopener" href="https://github.com/assimp/assimp">Open Asset Import Library (assimp)</a> to load various 3d file formats into a shared, in-memory format, which supports not only .fbx and .obj files but also have a nice general compatability over 40+ formats and integration with C++ codes. (Some models are slightly adjusted using blender and 3dsmax for a better effect)</li>
<li>Handle the physics force simulation, process collision detection, and render object behaviors between physical entities, with optimized algorithm complexity and reliability tests to ensure a smooth user experience and stable system functions.</li>
<li>Real time shadows are dynamically rendered under each billiard ball for a better visual effects.</li>
<li>Design two game mode with respective game rule and global scoring mechanism.</li>
<li>Implement an adaptive AI opponent with intellginent behavior and adaptive features to select optimal shots and strategies according to different scoring rules. (The specs are explained in the following chapters)</li>
</ol>
<h2 id="AI-Opponent-Algorithm"><a href="#AI-Opponent-Algorithm" class="headerlink" title="AI Opponent Algorithm"></a>AI Opponent Algorithm</h2><p>To implement an AI opponent for billiards game, I consulted a number of papers to learn about successful methodologies, for which I combined and applied in this project using an adaptive approach.<br><strong><a target="_blank" rel="noopener" href="https://citeseerx.ist.psu.edu/document?repid=rep1&type=pdf&doi=e7aa4fbc27f7db06bed79a8220684c704a547ae6">“Running the Table: An AI for Computer Billiards”</a></strong> (Michael Smith, 2006), proposed an adaption of game search techniques to the continuous, stochastic domain of billiards.  This paper deeply analyzed the gaming logic behind billiards game, that is to consider three factors affecting the quality of shots: contribution to goals, shots safety, and resulting state. It discussed and compared two search algorithms: <strong>probabilistic search</strong> (a special case of expectimax) and <strong>Monte-Carlo sampling search</strong>, with the following pseudocode: </p>
<div align="center"><img src="/img/billmc.png" width="350px"></img><img src="/img/billps.png" width="350px"></img></div>
The shot difficuty is defined as a function of angles and object distances in this paper. Based on this, it introduced the technique of estimating shot difficulties via a lookup table and approach to move generation, where the evaluation function is described as the weighted average of shot discount factors and estimated probability of shots. 

<p>Another paper <strong><a target="_blank" rel="noopener" href="https://www.researchgate.net/publication/225328639_AI_Optimization_of_a_Billiard_Player">“AI Optimization of a Billiard Player”</a></strong> (Jean-François Landry, Jean-Pierre Dussault, 2007) broken down the billiards simulation with optimization techiniques. It first defines the ball movements equation on a pool table:</p>
<div align="center"><img src="/img/billmv.png"></img></img></div>
Based on this equation, collision between two balls can be detected under the following condition:
<div align="center"><img src="/img/billmv2.png"></img></img></div>
The evaluation is then considered from the following aspects:

<ul>
<li>Sink aimed ball in the pocket with minimum speed.</li>
<li>Prevent scratching of cue ball.</li>
<li>Insure good repositionning of the cue ball for next shot.</li>
<li>Insure the shot is legal (we do not hit an opponent’s ball first)</li>
</ul>
<p>And this gives rise to the complete object function:</p>
<div align="center"><img src="/img/billof.png"></img></img></div>

<h2 id="Genetic-Algorithm-Optimization"><a href="#Genetic-Algorithm-Optimization" class="headerlink" title="Genetic Algorithm Optimization"></a>Genetic Algorithm Optimization</h2><p>For the above algorithms we have discussed so far, the key  is to find the most appropriate angle and force to shoot the cue ball. Given that nice analytical solutions are presented in the exsited papers, the random serach is an inevitable part of their algorithms, despite the complexity can be reduced by ignoring unnecessary parts from the mathematical computing results.<br>In this project, based on the presented analytical models, we take <strong>Genetic Algorthm</strong> to optimize the efficiency of search function, making the whole AI simulation and evaluation process even faster.<br>Similar to lifeforms, we want our AI to evolve and become better at the task we give him to do. And the basic idea of genetic algorithms is to utilize the knowledge transfer from one generation to the next and improvement the AI performance over each iteration. To implement this, in every iteration, we store the best sets of parameters we had so far and mutate them with a little variation and put them into next iteration.<br>But we should also consider to introduce a completely irrelevant random set to add some diversity into simulation, which could help to resolve overfitting issues and avoid falling into local optimization situation. The skeleton code of genetic algorithm is:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">MAX_PACE = 0.5;</span><br><span class="line">MIN_PACE = 0.01;</span><br><span class="line">MAX_ITERATIONS = 150;</span><br><span class="line">DIVERSITY_INDEX = 10;</span><br><span class="line"></span><br><span class="line">bestParams = null;</span><br><span class="line">highestScore = 0;</span><br><span class="line">forceMutation = 0.005;</span><br><span class="line">angleMutation = 0.001</span><br><span class="line"></span><br><span class="line">for(let i = 0 ; i &lt; MAX_ITERATIONS ; i++) &#123;</span><br><span class="line"></span><br><span class="line">    angle=0;</span><br><span class="line">    force=0.05;</span><br><span class="line"></span><br><span class="line">    if (i % DIVERSITY_INDEX === 0) &#123;</span><br><span class="line">        // Randomize</span><br><span class="line">        angle = (Math.random() * 2 * Math.PI)</span><br><span class="line">        force = (Math.random() * MAX_PACE);</span><br><span class="line">    &#125; </span><br><span class="line">    else &#123;</span><br><span class="line">        // Mutate</span><br><span class="line">        angle = bestParams.angle;</span><br><span class="line">        angle += angleMutation * (Math.random() * 2 * Math.PI - Math.PI);</span><br><span class="line"></span><br><span class="line">        force = bestParams.force;</span><br><span class="line">        force += (Math.random() * 2 * forceMutation) - forceMutation;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Limit force</span><br><span class="line">    force = force &lt; MIN_PACE ? MIN_PACE : force;</span><br><span class="line">    force = force &gt; MAX_PACE ? MAX_PACE : force;</span><br><span class="line"></span><br><span class="line">    params = &#123;</span><br><span class="line">        angle,</span><br><span class="line">        force</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">   score = eval(params);</span><br><span class="line"></span><br><span class="line">    if(!bestParams || score &gt; highestScore) &#123;</span><br><span class="line">        bestParams = params;</span><br><span class="line">        highestScore = score;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">simulate(bestParams);</span><br></pre></td></tr></table></figure>

<h2 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h2><ol>
<li><p>The Billiards table and ball models are sourced from <a target="_blank" rel="noopener" href="https://sketchfab.com/3d-models/pool-table-353ac8a56c6b427592666eb01dfec65b">Sketchfab</a>, with minor modifications to fit the scene by myself using Blender and 3dsMax 2022.</p>
<div align="center"><img src="/img/blender.png"></img></img></div>
</li>
<li><p>In proposal, an animated character referee of the game is suggested. Actually this was implemented, but with the introduction of AI opponent and relevant complicated algorithm, the system will become very laggy if trying to simutaneously render the animation of character with thousands of vertices in the same scene.<br>So I have to split the character into independent scenes, but this reduces the logic relationship between them. They will only function separetely, so the existence of referee becomes meaningless. Considering the focus of this project is on AI algorithm, so this part is not included in the final presentation. However, here is a clip of video showing the work I have done to render the animated referee, which will behave differently according to the scoring status on game.</p>
<div align="center">
<iframe width="560" height="315" src="https://www.youtube.com/embed/a_k4Y5QtZ_c?si=e4FIjetysjMaKSk8" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe></div>
Note that the animation of character can be dynamically switched without interrupting the physical simulation of bouncing balls, which was designed to correspond to the gameplay status of billiards.

</li>
<li><p>References</p>
</li>
</ol>
<ul>
<li>Assimp Library: <a target="_blank" rel="noopener" href="https://github.com/assimp/assimp">https://github.com/assimp/assimp</a></li>
<li>Academic Papers: <strong><a target="_blank" rel="noopener" href="https://citeseerx.ist.psu.edu/document?repid=rep1&type=pdf&doi=e7aa4fbc27f7db06bed79a8220684c704a547ae6">“Running the Table: An AI for Computer Billiards”</a></strong> (Michael Smith, 2006), <strong><a target="_blank" rel="noopener" href="https://www.researchgate.net/publication/225328639_AI_Optimization_of_a_Billiard_Player">“AI Optimization of a Billiard Player”</a></strong> (Jean-François Landry, Jean-Pierre Dussault, 2007), <strong><a href="/attaches/CV.pdf">“Billiard-AI”</a></strong> (Lukas Seglias, Luca Ritz)</li>
<li>Github repositorys: <a target="_blank" rel="noopener" href="https://github.com/henshmi/Classic-8-Ball-Pool">Classic-8-Ball-Pool</a>,  <a target="_blank" rel="noopener" href="https://github.com/mgerdes/billiards">Billiards</a></li>
</ul>
</article></div></main><div class="nav-wrap"><div class="nav"><button class="site-nav"><div class="navicon"></div></button><ul class="nav_items"><li class="nav_item"><a class="nav-page" href="/research"> Project</a></li><li class="nav_item"><a class="nav-page" href="/works"> Game</a></li><li class="nav_item"><a class="nav-page" href="/exps"> Award</a></li><li class="nav_item"><a class="nav-page" href="/awards"> Certificate</a></li><li class="nav_item"><a class="nav-page" target="_blank" rel="noopener" href="https://github.com/RyanbowZ"> GitHub</a></li><li class="nav_item"><a class="nav-page" href="/"> About</a></li></ul></div><div class="cd-top"><i class="fa fa-arrow-up" aria-hidden="true"></i></div></div><footer id="page_footer"><div class="footer_wrap"><div class="copyright">&copy;2022 - 2025 by Yuanlong Zhou</div><div class="theme-info">Powered by <a target="_blank" href="https://hexo.io" rel="nofollow noopener">Hexo</a> & <a target="_blank" href="https://github.com/PhosphorW/hexo-theme-academia" rel="nofollow noopener">Academia Theme</a></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery-pjax@latest/jquery.pjax.min.js"></script><script src="/js/main.js"></script></body></html>